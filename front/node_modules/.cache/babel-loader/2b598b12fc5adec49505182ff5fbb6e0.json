{"ast":null,"code":"var _jsxFileName = \"/Users/alex-lz/Desktop/vendimia/front/src/views/RegistroVentas.js\";\nimport React, { Component } from 'react';\nimport Button from '../components/Button';\nimport TableArt from '../components/TableArt';\nimport Textin from '../components/Textin';\nimport Autocomplete from '../components/Autocomplete';\nimport AutocompleteArt from '../components/AutocompleteArt';\nimport '../views/RegistroVentas.css';\nimport config from '../config';\nimport './components/TableArt.css';\nlet dataArts = [];\nlet listArts = [];\nlet listMod = [];\nlet listCan = [];\nlet listPre = [];\nlet listClients = [];\nlet listKeys = [];\nlet listRfcs = [];\n\nclass Ventas extends Component {\n  constructor(props) {\n    super(props);\n\n    this.add = () => {\n      // dataArts.push('Hola');\n      alert(\"Hello! I am an alert box!!\");\n    };\n\n    this.add = () => {\n      let obj = localStorage.getObj(\"Venta\");\n      let precioArt = parseFloat(localStorage.precio);\n      let cantidad = parseFloat(localStorage.cantidad);\n      let tasa = parseFloat(localStorage.tasa);\n      let plazo = parseFloat(localStorage.plazo);\n      let precio = precioArt * (1 + tasa * plazo / 100);\n      let importe = precio * cantidad;\n\n      if (obj) {\n        obj.push([localStorage.descripcion, localStorage.modelo, localStorage.cantidad, precio, importe]);\n        localStorage.setObj(\"Venta\", obj);\n        this.setState({\n          venta: obj\n        });\n      } else {\n        obj = [[localStorage.descripcion, localStorage.modelo, localStorage.cantidad, precio, importe]];\n        localStorage.setObj(\"Venta\", obj);\n        this.setState({\n          venta: obj\n        });\n      }\n    };\n\n    this.delete = id => {\n      let obj = localStorage.getObj(\"Venta\"); //()=>document.getElementById(idRow).remove(\n\n      var index = obj.indexOf(id);\n\n      if (index > -1) {\n        obj.splice(index, 1);\n      }\n\n      localStorage.setObj(\"Venta\", obj);\n    };\n\n    this.state = {\n      venta: [],\n      folio: 0\n    };\n  }\n\n  componentDidMount() {\n    fetch(config.apiUrl + '/ventas_folio').then(results => {\n      return results.json();\n    }).then(data => {\n      let configuracion = data.folios.map(fol => {\n        let folio = fol.folio;\n        this.setState({\n          folio: folio\n        });\n      });\n      this.setState({\n        configuracion: configuracion\n      });\n    });\n    fetch(config.apiUrl + '/config_get').then(results => {\n      return results.json();\n    }).then(data => {\n      console.log(data.config);\n      let configuracion = data.config.map(dato => {\n        localStorage.tasa = dato.tasa_financiamiento;\n        localStorage.enganche = dato.enganche;\n        localStorage.plazo = dato.plazo_maximo;\n      });\n      this.setState({\n        configuracion: configuracion\n      });\n    }); // venta = localStorage.getObj(\"Venta\");\n\n    fetch(config.apiUrl + '/clientes_get').then(results => {\n      return results.json();\n    }).then(data => {\n      console.log(data.clientes);\n      let configuracion = data.clientes.map(cliente => {\n        // datos.push([ cliente.clave, cliente.nombre, cliente.apellido_p, cliente.apellido_m, cliente.rfc ] );\n        listClients.push(cliente.nombre + ' ' + cliente.apellido_p + ' ' + cliente.apellido_m);\n        listKeys.push(cliente.clave);\n        listRfcs.push(cliente.rfc);\n      });\n      this.setState({\n        configuracion: configuracion\n      });\n    });\n    fetch(config.apiUrl + '/articulos_get').then(results => {\n      return results.json();\n    }).then(data => {\n      console.log(data.articulos);\n      let configuracion = data.articulos.map(art => {\n        dataArts.push([art.descripcion, art.modelo, art.cantidad, art.precio]);\n        listArts.push(art.descripcion);\n        listMod.push(art.modelo);\n        listCan.push(art.cantidad);\n        listPre.push(art.precio);\n      });\n      this.setState({\n        configuracion: configuracion\n      });\n    });\n  }\n\n  render() {\n    let idRow = \"\";\n    let contRow = 0;\n    const tableDates = this.state.venta.map(dateRow => {\n      let cont = 0;\n      contRow += 1;\n      idRow = \"row\" + contRow + Math.random();\n      return React.createElement(\"tr\", {\n        id: idRow,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, dateRow.map(date => {\n        cont += 1;\n        return React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }, date, cont === 5 ? React.createElement(\"a\", {\n          className: \"btn circle ired\",\n          onClick: this.delete(contRow),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }, \"x\") : null);\n      }));\n    });\n    let fields = ['Descrpción Articulo', 'Modelo', 'Cantidad', 'Precio', 'Importe'];\n    const tableFields = fields.map(field => React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, field));\n    return React.createElement(\"div\", {\n      className: \"form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, \"Registro Ventas\"), React.createElement(\"p\", {\n      className: \"folio\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, 'Folio Venta: ' + this.state.folio), React.createElement(\"div\", {\n      className: \"formContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(Button, {\n      sty: \"btn iblue\",\n      txt: \"Cliente\",\n      func: \"del\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }), React.createElement(Autocomplete, {\n      dates: listClients,\n      claves: listKeys,\n      rfc: listRfcs,\n      ph: \"Buscar cliente...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }), React.createElement(Button, {\n      sty: \"btn iblue\",\n      txt: \"Articulo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }), React.createElement(AutocompleteArt, {\n      dates: dataArts,\n      arts: listArts,\n      modelo: listMod,\n      cantidad: listCan,\n      precio: listPre,\n      ph: \"Buscar articulo...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }), React.createElement(\"a\", {\n      className: \"btn square igreen\",\n      onClick: this.add,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, \"+\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }), React.createElement(TableArt, {\n      fields: ['Descrpción Articulo', 'Modelo', 'Cantidad', 'Precio', 'Importe'],\n      dates: this.state.venta,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"tableArt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, tableFields)), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, tableDates))));\n  }\n\n}\n\nexport default Ventas;","map":{"version":3,"sources":["/Users/alex-lz/Desktop/vendimia/front/src/views/RegistroVentas.js"],"names":["React","Component","Button","TableArt","Textin","Autocomplete","AutocompleteArt","config","dataArts","listArts","listMod","listCan","listPre","listClients","listKeys","listRfcs","Ventas","constructor","props","add","alert","obj","localStorage","getObj","precioArt","parseFloat","precio","cantidad","tasa","plazo","importe","push","descripcion","modelo","setObj","setState","venta","delete","id","index","indexOf","splice","state","folio","componentDidMount","fetch","apiUrl","then","results","json","data","configuracion","folios","map","fol","console","log","dato","tasa_financiamiento","enganche","plazo_maximo","clientes","cliente","nombre","apellido_p","apellido_m","clave","rfc","articulos","art","render","idRow","contRow","tableDates","dateRow","cont","Math","random","date","fields","tableFields","field"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Button from '../components/Button'\nimport TableArt from '../components/TableArt'\nimport Textin from '../components/Textin'\nimport Autocomplete from '../components/Autocomplete'\nimport AutocompleteArt from '../components/AutocompleteArt'\nimport '../views/RegistroVentas.css';\nimport config from '../config'\nimport './components/TableArt.css'\n\nlet dataArts = [];\nlet listArts = [];\nlet listMod = [];\nlet listCan = [];\nlet listPre = [];\nlet listClients = [];\nlet listKeys = [];\nlet listRfcs = [];\n\nclass Ventas extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      venta: [],folio:0\n    };\n  }\n\n  componentDidMount() {\n    fetch(config.apiUrl + '/ventas_folio')\n    .then(results => { \n      return results.json() \n    })\n    .then(data => { \n      let configuracion = data.folios.map((fol) => {\n      let folio = fol.folio;\n       this.setState({folio: folio})\n    })\n    this.setState({configuracion: configuracion})\n       \n    })\n\n    fetch(config.apiUrl + '/config_get')\n    .then(results => { \n      return results.json() \n    })\n    .then(data => { \n      console.log(data.config)\n       let configuracion = data.config.map((dato) => {\n           localStorage.tasa = dato.tasa_financiamiento;\n           localStorage.enganche = dato.enganche;\n           localStorage.plazo = dato.plazo_maximo;\n       })\n       this.setState({configuracion: configuracion})\n    })\n   // venta = localStorage.getObj(\"Venta\");\n    fetch(config.apiUrl + '/clientes_get')\n    .then(results => { \n      return results.json() \n    })\n    .then(data => { \n      console.log(data.clientes)\n       let configuracion = data.clientes.map((cliente) => {\n           // datos.push([ cliente.clave, cliente.nombre, cliente.apellido_p, cliente.apellido_m, cliente.rfc ] );\n           listClients.push( cliente.nombre + ' ' + cliente.apellido_p + ' ' + cliente.apellido_m );\n           listKeys.push( cliente.clave );\n           listRfcs.push( cliente.rfc );\n       })\n       this.setState({configuracion: configuracion})\n    })\n\n    fetch(config.apiUrl + '/articulos_get')\n    .then(results => { \n      return results.json() \n    })\n    .then(data => { \n      console.log(data.articulos)\n       let configuracion = data.articulos.map((art) => {\n           dataArts.push([ art.descripcion, art.modelo, art.cantidad, art.precio ]);\n           listArts.push( art.descripcion );\n           listMod.push( art.modelo );\n           listCan.push( art.cantidad );\n           listPre.push( art.precio );\n       })\n       this.setState({configuracion: configuracion})\n    })\n  }\n\n  add = () => {\n    // dataArts.push('Hola');\n    alert(\"Hello! I am an alert box!!\");\n  }\n\n  add = () => {\n    let obj = localStorage.getObj(\"Venta\");\n    let precioArt = parseFloat(localStorage.precio);\n    let cantidad = parseFloat(localStorage.cantidad);\n    let tasa = parseFloat(localStorage.tasa);\n    let plazo = parseFloat(localStorage.plazo);\n\n    let precio = precioArt * (1 + ((tasa*plazo)/100) )\n    let importe = precio * cantidad;\n\n    if(obj){\n        obj.push([localStorage.descripcion, localStorage.modelo, localStorage.cantidad, precio, importe]);\n        localStorage.setObj(\"Venta\", obj);\n        this.setState({ venta: obj });\n    } else{\n        obj = [[localStorage.descripcion, localStorage.modelo, localStorage.cantidad, precio, importe]];\n        localStorage.setObj(\"Venta\", obj);\n        this.setState({ venta: obj });\n    }\n  };\n\n  delete = (id) => {\n    let obj = localStorage.getObj(\"Venta\");\n    //()=>document.getElementById(idRow).remove(\n      var index = obj.indexOf(id);\n      if (index > -1) {\n        obj.splice(index, 1);\n      }\n     localStorage.setObj(\"Venta\", obj);\n  }\n\n  render() {\n    let idRow = \"\";\n    let contRow = 0;\n    const tableDates = this.state.venta.map((dateRow) => {\n        let cont = 0;\n\n        contRow += 1;\n        idRow = \"row\"+contRow+Math.random();\n        return(\n        <tr id={idRow}>\n          {  dateRow.map((date) => {\n             cont += 1;\n             return(\n             <td>\n                {date}\n                {cont === 5 ? <a className=\"btn circle ired\" onClick={this.delete(contRow)}>x</a>:null}\n             </td> ) \n          }) }\n        </tr> )\n    });\n    let fields = ['Descrpción Articulo', 'Modelo', 'Cantidad', 'Precio', 'Importe'];\n    const tableFields = fields.map((field) => \n      <th>\n        {field}\n      </th>\n    );\n    return (\n      <div className=\"form\">\n          <p className=\"title\">Registro Ventas</p>\n          <p className=\"folio\">{'Folio Venta: ' + this.state.folio}</p>\n          <div className=\"formContainer\">\n          <Button \n            sty=\"btn iblue\" \n            txt=\"Cliente\"\n            func=\"del\"\n          />\n          <Autocomplete\n            dates={listClients}\n            claves={listKeys}\n            rfc={listRfcs}\n            ph=\"Buscar cliente...\"\n          />\n          <hr />\n          <Button \n            sty=\"btn iblue\" \n            txt=\"Articulo\"\n          />\n          <AutocompleteArt\n            dates={dataArts}\n            arts={listArts}\n            modelo={listMod}\n            cantidad={listCan}\n            precio={listPre}\n            ph=\"Buscar articulo...\"\n          />\n          <a className=\"btn square igreen\" onClick={this.add}>+</a>\n          </div>\n          <br />\n          <TableArt\n            fields={['Descrpción Articulo', 'Modelo', 'Cantidad', 'Precio', 'Importe']}\n            dates={this.state.venta} \n          />\n        <div className=\"tableArt\">\n        <table>\n\t      <thead>\n\t      <tr>\n\t      \t{tableFields}\n\t      </tr>\n\t      </thead>\n\t      <tbody>\n\t        {tableDates}\n\t      </tbody>\n        </table>\n      </div>\n      </div>\n    );\n  }\n}\n\nexport default Ventas;"]},"metadata":{},"sourceType":"module"}